
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Middleware Â· Neutrino</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-npmsearchlist/styles.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="neutrino-middleware-banner/" />
    
    
    <link rel="prev" href="../presets/community-presets.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../installation.html">
            
                <a href="../installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../usage.html">
            
                <a href="../usage.html">
            
                    
                    Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../project-layout.html">
            
                <a href="../project-layout.html">
            
                    
                    Project Layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../FAQ.html">
            
                <a href="../FAQ.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../learning-resources.html">
            
                <a href="../learning-resources.html">
            
                    
                    Learning Resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../cli/">
            
                <a href="../cli/">
            
                    
                    CLI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../api/">
            
                <a href="../api/">
            
                    
                    API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../webpack-chain.html">
            
                <a href="../webpack-chain.html">
            
                    
                    Configuration API - webpack-chain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../customization/">
            
                <a href="../customization/">
            
                    
                    Customization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../creating-presets.html">
            
                <a href="../creating-presets.html">
            
                    
                    Creating presets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../upgrading-neutrino.html">
            
                <a href="../upgrading-neutrino.html">
            
                    
                    Upgrading from v6 to v7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../presets/">
            
                <a href="../presets/">
            
                    
                    Presets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../presets/neutrino-preset-web/">
            
                <a href="../presets/neutrino-preset-web/">
            
                    
                    Web
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../presets/neutrino-preset-react/">
            
                <a href="../presets/neutrino-preset-react/">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../presets/neutrino-preset-node/">
            
                <a href="../presets/neutrino-preset-node/">
            
                    
                    Node.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" data-path="../presets/neutrino-preset-airbnb-base/">
            
                <a href="../presets/neutrino-preset-airbnb-base/">
            
                    
                    Airbnb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.5" data-path="../presets/neutrino-preset-karma/">
            
                <a href="../presets/neutrino-preset-karma/">
            
                    
                    Karma
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.6" data-path="../presets/neutrino-preset-mocha/">
            
                <a href="../presets/neutrino-preset-mocha/">
            
                    
                    Mocha
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.7" data-path="../presets/neutrino-preset-jest/">
            
                <a href="../presets/neutrino-preset-jest/">
            
                    
                    Jest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.8" data-path="../presets/community-presets.html">
            
                <a href="../presets/community-presets.html">
            
                    
                    Community presets
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.14" data-path="./">
            
                <a href="./">
            
                    
                    Middleware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="neutrino-middleware-banner/">
            
                <a href="neutrino-middleware-banner/">
            
                    
                    banner
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="neutrino-middleware-chunk/">
            
                <a href="neutrino-middleware-chunk/">
            
                    
                    chunk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="neutrino-middleware-clean/">
            
                <a href="neutrino-middleware-clean/">
            
                    
                    clean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="neutrino-middleware-compile-loader/">
            
                <a href="neutrino-middleware-compile-loader/">
            
                    
                    compile-loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="neutrino-middleware-copy/">
            
                <a href="neutrino-middleware-copy/">
            
                    
                    copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="neutrino-middleware-env/">
            
                <a href="neutrino-middleware-env/">
            
                    
                    env
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.7" data-path="neutrino-middleware-eslint/">
            
                <a href="neutrino-middleware-eslint/">
            
                    
                    eslint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.8" data-path="neutrino-middleware-font-loader/">
            
                <a href="neutrino-middleware-font-loader/">
            
                    
                    font-loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.9" data-path="neutrino-middleware-hot/">
            
                <a href="neutrino-middleware-hot/">
            
                    
                    hot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.10" data-path="neutrino-middleware-html-loader/">
            
                <a href="neutrino-middleware-html-loader/">
            
                    
                    html-loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.11" data-path="neutrino-middleware-html-template/">
            
                <a href="neutrino-middleware-html-template/">
            
                    
                    html-template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.12" data-path="neutrino-middleware-image-loader/">
            
                <a href="neutrino-middleware-image-loader/">
            
                    
                    image-loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.13" data-path="neutrino-middleware-loader-merge/">
            
                <a href="neutrino-middleware-loader-merge/">
            
                    
                    loader-merge
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.14" data-path="neutrino-middleware-minify/">
            
                <a href="neutrino-middleware-minify/">
            
                    
                    minify
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.15" data-path="neutrino-middleware-pwa/">
            
                <a href="neutrino-middleware-pwa/">
            
                    
                    pwa
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.16" data-path="neutrino-middleware-start-server/">
            
                <a href="neutrino-middleware-start-server/">
            
                    
                    start-server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.17" data-path="neutrino-middleware-style-loader/">
            
                <a href="neutrino-middleware-style-loader/">
            
                    
                    style-loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.18" data-path="community-middleware.html">
            
                <a href="community-middleware.html">
            
                    
                    Community middleware
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <a target="_blank" href="https://github.com/mozilla-neutrino/neutrino-dev/tree/docs-v6/docs">
            
                    
                    v6 Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
                <a target="_blank" href="https://github.com/mozilla-neutrino/neutrino-dev/tree/docs-v5/docs">
            
                    
                    v5 Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" >
            
                <a target="_blank" href="https://github.com/mozilla-neutrino/neutrino-dev/tree/docs-v4/docs">
            
                    
                    v4 Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../contributing/">
            
                <a href="../contributing/">
            
                    
                    Contributing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../contributing/development.html">
            
                <a href="../contributing/development.html">
            
                    
                    Development Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../contributing/code-of-conduct.html">
            
                <a href="../contributing/code-of-conduct.html">
            
                    
                    Code of Conduct
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Middleware</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="middleware">Middleware</h1>
<p>The basic unit of interacting with Neutrino is middleware. Middleware can modify configuration,
listen for events, get build metadata, or augment Neutrino with custom functionality.</p>
<h2 id="formats">Formats</h2>
<p>Neutrino middleware can be specified in several different formats depending on the complexity and level of
customization needed. The Neutrino API and CLI operate on the concept that they are provided a collection of middleware.
Specifically:</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// The Neutrino API can use many middleware when it is run()</span>
neutrino<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&apos;command&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token comment" spellcheck="true">/* array of middleware */</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// When no middleware has been specified to run, it defaults</span>
<span class="token comment" spellcheck="true">// to an array only containing the local .neutrinorc.js file</span>
neutrino<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&apos;command&apos;</span><span class="token punctuation">)</span>
</code></pre>
<pre class="language-"><code class="lang-bash"><span class="token comment" spellcheck="true"># The Neutrino CLI can use many middleware when running a command</span>
&#x276F; neutrino <span class="token function">command</span> --use middleware_a middleware_b

<span class="token comment" spellcheck="true"># When no middleware has been specified to the CLI, it defaults</span>
<span class="token comment" spellcheck="true"># to an array only containing the local .neutrinorc.js file</span>
&#x276F; neutrino <span class="token function">command</span>
</code></pre>
<p>Each item in these collections can be provided in a number of different formats. For example, the CLI can only directly
accept string formats, while the API and required middleware can be of any supported format.</p>
<p>The string and array formats are generally used from within the more powerful object and function formats.</p>
<h3 id="string-format">String format</h3>
<p>Providing a string as a middleware item denotes it as being a require-able module. Neutrino will attempt to require
this string and then try to use its exports as another middleware format. For example, using the string
&quot;neutrino-preset-react&quot; will be required by Neutrino, and then be re-processed through Neutrino using its exports as a
different middleware type, depending on what that preset exported.</p>
<p>Using the string format is most commonly used to depend on other middleware. Referencing a string does not enable
access to the Neutrino API, and options can only be passed to the string middleware if using the Neutrino API&apos;s <code>use</code>
method.</p>
<pre class="language-"><code class="lang-bash"><span class="token comment" spellcheck="true"># String format on the CLI</span>
&#x276F; neutrino start --use neutrino-preset-react
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// String format exported from other middleware</span>
<span class="token comment" spellcheck="true">// not very useful, but possible</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// String format being used within an object-format .neutrinorc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// String format being used within function format</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> neutrino <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="array-format">Array format</h3>
<p>Providing an array as a middleware item denotes it as being a pair of middleware format and options, i.e.
<code>[middleware, options]</code>. The first item in the pair can be any other middleware format, although it is typically
specified as a string to require, and options to be passed to the required middleware.</p>
<p>Using the array format is most commonly used to depend on other middleware while being able to supply options to the
required middleware. Referencing an array does not enable access to the Neutrino API.</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Array format exported from other middleware</span>
<span class="token comment" spellcheck="true">// still not very useful, but possible</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Array format being used within an object-format .neutrinorc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Array format being used within an object-format .neutrinorc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// Array format being used within function format</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> neutrino <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="object-format">Object format</h3>
<p>Providing an object as a middleware item denotes it as being a more complex middleware structure capable of
overriding configuration and options. The object format is the recommended format when creating <code>.neutrinorc.js</code> files
as it provides a good balance between easily setting options and using other middleware. The object format can be
structured as follows:</p>
<pre class="language-"><code class="lang-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// specify options to override in the Neutrino API</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// for example, change the output directory to dist</span>
    output<span class="token punctuation">:</span> <span class="token string">&apos;dist&apos;</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// or set the default development port to 3000</span>
    port<span class="token punctuation">:</span> <span class="token number">3000</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment" spellcheck="true">// Specify environment-specific changes. This is a key-value</span>
  <span class="token comment" spellcheck="true">// mapping of environment variable names to their matching values</span>
  <span class="token comment" spellcheck="true">// during which to override. The matching environment value can</span>
  <span class="token comment" spellcheck="true">// be any middleware format</span>
  env<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    NODE_ENV<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// Require minify middleware during production</span>
      production<span class="token punctuation">:</span> <span class="token string">&apos;neutrino-middleware-minify&apos;</span><span class="token punctuation">,</span>

      <span class="token comment" spellcheck="true">// Use dev-server during development</span>
      development<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&apos;neutrino-middleware-dev-server&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token comment" spellcheck="true">// Use Jest during test-only</span>
      test<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-jest&apos;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    CSS_MODULES<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// Turn on CSS modules when the environment variable CSS_MODULES=enable</span>
      enable<span class="token punctuation">:</span> <span class="token punctuation">(</span>neutrino<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        neutrino<span class="token punctuation">.</span>config<span class="token punctuation">.</span>module
          <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&apos;style&apos;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&apos;css&apos;</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span> modules<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment" spellcheck="true">// The &quot;use&quot; array defines another set of middleware for Neutrino to use.</span>
  <span class="token comment" spellcheck="true">// Just like the CLI and API start with a collection of middleware to use,</span>
  <span class="token comment" spellcheck="true">// providing a &quot;use&quot; array specifies another list of middleware formats to work with</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment" spellcheck="true">// string format</span>
    <span class="token string">&apos;neutrino-preset-airbnb-base&apos;</span><span class="token punctuation">,</span>

    <span class="token comment" spellcheck="true">// array format</span>
    <span class="token punctuation">[</span><span class="token string">&apos;neutrino-preset-react&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> polyfills<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment" spellcheck="true">// function format</span>
    <span class="token punctuation">(</span>neutrino<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// Make whatever configuration overrides needed</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Hopefully it is clear that the object format is quite powerful, and although it doesn&apos;t give you direct access to the
Neutrino API, providing a function format <strong>within does</strong> give you API access.</p>
<h3 id="function-format">Function format</h3>
<p>The most powerful middleware format. Using a function as middleware gives direct access to the Neutrino API, configuration,
options, and events for modification, as well as being able to accept options for driving the behavior of the middleware.</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span>neutrino<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<p>A middleware function can optionally accept an <code>options</code> argument which will be fed back into
the middleware function when used. The options argument can be whatever value you accept.</p>
<p>If you&apos;re familiar with middleware from the Express/connect world, this works similarly. When using Express middleware,
you provide a function to Express which receives arguments to modify a request or response along its lifecycle. There
can be a number of middleware functions that Express can load, each one potentially modifying a request or response in
succession. Neutrino will execute middleware functions similarly, where each function successively interacts with Neutrino along
the lifecycle.</p>
<p>To use a concrete example, let&apos;s create middleware that adds an environment plugin:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> Neutrino <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;neutrino&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> EnvironmentPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;webpack&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">(</span>neutrino<span class="token punctuation">,</span> additionalVars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  neutrino<span class="token punctuation">.</span>config
    <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&apos;env&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>EnvironmentPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;NODE_ENV&apos;</span><span class="token punctuation">,</span> <span class="token operator">...</span>additionalVars<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// When this middleware gets used, options can be passed to it</span>
<span class="token comment" spellcheck="true">// depending on the format:</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&apos;your-env-middleware&apos;</span><span class="token punctuation">,</span>

    <span class="token punctuation">[</span><span class="token string">&apos;your-env-middleware&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;CSS_MODULES&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token punctuation">(</span>neutrino<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&apos;your-env-middleware&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;CSS_MODULES&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="loading-middleware">Loading middleware</h2>
<p>Additional middleware can also be loaded from a middleware function. This makes their composition simpler for
consumers.</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// neutrino-middleware-env</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> EnvironmentPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;webpack&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">(</span>neutrino<span class="token punctuation">,</span> additionalVars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> neutrino<span class="token punctuation">.</span>config
  <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&apos;env&apos;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>EnvironmentPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;NODE_ENV&apos;</span><span class="token punctuation">,</span> <span class="token operator">...</span>additionalVars<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// react preset (which is also middleware)</span>
<span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;neutrino-middleware-env&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> neutrino <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;SECRET_KEY&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* next middleware */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* next middleware */</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="configuring">Configuring</h2>
<p>If your middleware requires configuration <em>outside</em> of the options necessary for <em>running</em> the middleware,
use a closure technique for simplifying this for your middleware consumers. In short, your module will provide a
function to consumers which, when executed, will return a Neutrino middleware function. Describing this in code:</p>
<pre class="language-"><code class="lang-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span>neutrino<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// do something with neutrino, options, and args</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Let&apos;s create a contrived example using our <code>env</code> middleware. Let&apos;s use a closure to let the consumer provide an
alternate plugin name when creating the middleware:</p>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// neutrino-middleware-env</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> EnvironmentPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;webpack&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">(</span>pluginName <span class="token operator">=</span> <span class="token string">&apos;env&apos;</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>neutrino<span class="token punctuation">,</span> additionalVars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    neutrino<span class="token punctuation">.</span>config
      <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>pluginName<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>EnvironmentPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;NODE_ENV&apos;</span><span class="token punctuation">,</span> <span class="token operator">...</span>additionalVars<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment" spellcheck="true">// react preset (which is also middleware)</span>
<span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;neutrino-middleware-env&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> neutrino <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  neutrino<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">env</span><span class="token punctuation">(</span><span class="token string">&apos;ENV-PLUGIN&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;SECRET_KEY&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="distributing">Distributing</h2>
<p>If you would like your middleware to be used by others, feel free to publish and distribute! By putting your middleware
on npm, GitHub, or another location, you can share the hard work put into abstracting away Neutrino and Webpack
interactions and save everyone in the community time and effort. As long as the Neutrino CLI, other middleware, or
presets can require your middleware, it puts no restrictions on where you want to host it.</p>
<h2 id="core-middleware">Core middleware</h2>
<p>Neutrino maintains a number of core middleware packages which aid in creating the various preset packages we also
distribute. Continue onward for documentation on these various middleware packages.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../presets/community-presets.html" class="navigation navigation-prev " aria-label="Previous page: Community presets">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="neutrino-middleware-banner/" class="navigation navigation-next " aria-label="Next page: banner">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Middleware","level":"1.14","depth":1,"next":{"title":"banner","level":"1.14.1","depth":2,"path":"middleware/neutrino-middleware-banner/README.md","ref":"./middleware/neutrino-middleware-banner/README.md","articles":[]},"previous":{"title":"Community presets","level":"1.13.8","depth":2,"path":"presets/community-presets.md","ref":"./presets/community-presets.md","articles":[]},"dir":"ltr"},"config":{"plugins":["edit-link","prism","-highlight","github","anchorjs","npmsearchlist"],"root":"./docs","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{},"github":{"url":"https://github.com/mozilla-neutrino/neutrino-dev/"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"npmsearchlist":{},"fontsettings":{"theme":"white","family":"sans","size":2},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit page","base":"https://github.com/mozilla-neutrino/neutrino-dev/tree/master/docs"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Neutrino","gitbook":"*"},"file":{"path":"middleware/README.md","mtime":"2017-11-08T14:33:07.266Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-11-08T14:33:14.447Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-npmsearchlist/script.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

